<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statsig Feature Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@statsig/js-client@1/build/statsig-js-client.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
    </style>
</head>
<body>
    <h1>TechGear - Statsig Demo Store</h1>
    <p>Welcome to the Statsig Feature Test</p>
    <button id="checkGateButton">Check Gate</button>
    <div id="result">Result: Not Checked</div>

    <script>
      function getBrowserName() {
          const userAgent = navigator.userAgent;

          if (userAgent.includes('Chrome') && !userAgent.includes('Edg') && !userAgent.includes('OPR')) {
              return 'Chrome';
          } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {
              return 'Safari';
          } else if (userAgent.includes('Firefox')) {
              return 'Firefox';
          } else if (userAgent.includes('Edg')) {
              return 'Edge';
          } else if (userAgent.includes('OPR')) {
              return 'Opera';
          } else {
              return 'Unknown';
          }
      }

      async function initializeStatsig() {
          try {
              const userID = '3cK58mzYUTp2TAvfbVZWq'; // Use the actual user ID
              const browserName = getBrowserName();
              const apiKey = 'client-iP1C5UeGqpTQsrLm851hJDdmBXr70bNayiqkKTzla75';

              // Initialize Statsig with user attributes including browser name
              await Statsig.initialize(apiKey, { 
                  userID: userID, 
                  browserName: browserName 
              });

              console.log('Statsig initialized:', browserName);

              // Check the feature gate
              document.getElementById('checkGateButton').addEventListener('click', async function () {
                  const status = await Statsig.checkGate('new_feature_launch');
                  document.getElementById('result').innerText = (status ? 'Passed' : 'Failed');
                  console.log('Feature gate status:', status);
              });
          } catch (error) {
              console.error('Statsig initialization failed:', error);
          }
      }

      document.addEventListener('DOMContentLoaded', () => {
          initializeStatsig();
      });
    </script>
</body>
</html>
