<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="stylesheet.css" />
    <title>Statsig Feature Test</title>
    <!-- Lade die Statsig JavaScript-Bibliothek -->
    <script>
      var scrpt = document.createElement('script');
      scrpt.src =
        'https://cdn.jsdelivr.net/npm/statsig-js/build/statsig-prod-web-sdk.min.js';
      document.getElementsByTagName('head')[0].appendChild(scrpt);
    </script>
  </head>
  <body>
    <h1>Welche Produktversion kann ich verwenden?</h1>
    <p>
      wir prüfen dein browser type, in welche land du gerade bist, wann du
      produkt anfragen , für dich ein richitge Produkt version zu geben!
    </p>

    <!-- Button für Browser Check -->
    <button id="checkBrowserButton">Check my Browser</button>
    <div id="browserResult" class="check-result">Result: Not Checked</div>

    <!-- Button für Ländercode Check -->
    <button id="checkCountryButton">Check my Country</button>
    <div id="countryResult" class="check-result">Result: Not Checked</div>

    <!-- Button für Early Bird Check -->
    <button id="checkEarlyBirdButton">Check am I a Early Bird?</button>
    <div id="earlyBirdResult" class="check-result">Result: Not Checked</div>

    <script>
      document.addEventListener('DOMContentLoaded', async function () {
        scrpt.onload = async function () {
          try {
            const apiKey = 'client-iP1C5UeGqpTQsrLm851hJDdmBXr70bNayiqkKTzla75';

            // Benutzerdaten initialisieren
            const userData = {
              userID: '123',
              browser_name: navigator.userAgent,
              country: 'DE',
            };

            console.log('User Data:', userData);

            await statsig
              .initialize(apiKey, { user: userData })
              .then(() => {
                console.log('Statsig erfolgreich initialisiert.');
              })
              .catch((error) => {
                console.error('Fehler bei der Statsig-Initialisierung:', error);
                throw error;
              });
            // Event-Listener für den Browser-Button
            document
              .getElementById('checkBrowserButton')
              .addEventListener('click', async function () {
                try {
                  const browserGate = await statsig.checkGate(
                    'browser_name_chrome'
                  );
                  console.log('Browser Gate Result:', browserGate);
                  document.getElementById('browserResult').innerText =
                    browserGate
                      ? 'Herzlichen Glückwunsch! Du bist ein deutscher Benutzer, du kannst zuerst unsere Testversion ausprobieren!'
                      : 'Wie der Rest der Benutzer nutzt auch du unser offizielles Produkt.';
                } catch (gateError) {
                  console.error(
                    'Feature-Gate-Check für Browser fehlgeschlagen:',
                    gateError
                  );
                }
              });

            // Event-Listener für den Ländercode-Button
            document
              .getElementById('checkCountryButton')
              .addEventListener('click', async function () {
                try {
                  const countryGate = await statsig.checkGate('country_de');
                  console.log('Country Gate Result:', countryGate);
                  document.getElementById('countryResult').innerText =
                    countryGate
                      ? 'Herzlichen Glückwunsch! Du bist ein deutscher Benutzer, du kannst zuerst unsere Testversion ausprobieren!'
                      : 'Wie der Rest der Benutzer nutzt auch du unser offizielles Produkt.';
                } catch (gateError) {
                  console.error(
                    'Feature-Gate-Check für Land fehlgeschlagen:',
                    gateError
                  );
                }
              });

            // Event-Listener für den Early Bird-Button
            document
              .getElementById('checkEarlyBirdButton')
              .addEventListener('click', async function () {
                try {
                  const earlyBirdGate = await statsig.checkGate(
                    'before_august_4'
                  );
                  console.log('Early Bird Gate Result:', earlyBirdGate);
                  document.getElementById('earlyBirdResult').innerText =
                    earlyBirdGate
                      ? 'Herzlichen Glückwunsch! Du bist ein Early Bird, du kannst zuerst unsere Testversion ausprobieren!'
                      : 'Wie der Rest der Benutzer nutzt auch du unser offizielles Produkt.';
                } catch (gateError) {
                  console.error(
                    'Feature-Gate-Check für Early Bird fehlgeschlagen:',
                    gateError
                  );
                }
              });
          } catch (error) {
            console.error('Statsig-Initialisierung fehlgeschlagen:', error);
          }
        };
      });
    </script>
  </body>
</html>
